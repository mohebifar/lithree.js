!function(a){"use strict";function b(){var a=new p;return a.vertices=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],a.vertexIndex=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],a.vertexNormals=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],a.darwingFunction=g.drawingFunctions.ELEMENTS,a.drawingMode=g.drawingMode.TRIANGLES,a}function c(){for(var a=void 0===arguments[0]?1:arguments[0],b=void 0===arguments[1]?30:arguments[1],c=void 0===arguments[2]?30:arguments[2],d=new p,e=[],f=[],h=[],i=0;b>=i;i++)for(var j=i*Math.PI/b,k=Math.sin(j),l=Math.cos(j),m=0;c>=m;m++){var n=2*m*Math.PI/c,o=Math.sin(n),q=Math.cos(n),r=q*k,s=l,t=o*k,u=1-m/c,v=1-i/b;f.push(r),f.push(s),f.push(t),h.push(u),h.push(v),e.push(a*r),e.push(a*s),e.push(a*t)}for(var w=[],i=0;b>i;i++)for(var m=0;c>m;m++){var x=i*(c+1)+m,y=x+c+1;w.push(x),w.push(y),w.push(x+1),w.push(y),w.push(y+1),w.push(x+1)}return d.vertexIndex=w,d.vertexNormals=f,d.vertices=e,d.darwingFunction=g.drawingFunctions.ELEMENTS,d.drawingMode=g.drawingMode.TRIANGLES,d}var d=function(a,b,c){b&&Object.defineProperties(a,b),c&&Object.defineProperties(a.prototype,c)},e=function(){function a(){var a=void 0===arguments[0]?.785398:arguments[0],b=void 0===arguments[1]?1:arguments[1],c=void 0===arguments[2]?.1:arguments[2],d=void 0===arguments[3]?100:arguments[3];this.fovy=a,this.aspect=b,this.near=c,this.far=d,this.matrix=new m,this.lookAt=[0,0,0],this.position=[0,0,5],this.up=[0,1,0],this._zoom=1}return d(a,null,{zoom:{set:function(a){if(1>a)throw"Zoom should be equal or greater than 1";this._zoom=a},get:function(){return this._zoom},enumerable:!0,configurable:!0},updatePerspective:{value:function(){var a=2*Math.atan(Math.tan(.5*this.fovy)/this._zoom);this.matrix.perspective(a,this.aspect,this.near,this.far)},writable:!0,enumerable:!0,configurable:!0}}),a}(),d=function(a,b,c){b&&Object.defineProperties(a,b),c&&Object.defineProperties(a.prototype,c)},f=function(){function a(){{var a=void 0===arguments[0]?1:arguments[0],b=void 0===arguments[1]?1:arguments[1],c=void 0===arguments[2]?1:arguments[2];void 0===arguments[3]?1:arguments[3]}this.array=[a,b,c]}return d(a,null,{hex:{set:function(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,b,c,d){return b+b+c+c+d+d});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);this.array[0]=parseInt(c[1],16)/255,this.array[1]=parseInt(c[2],16)/255,this.array[2]=parseInt(c[3],16)/255},get:function(){var a=function(a){var b=a.toString(16);return 1==b.length?"0"+b:b};return"#"+a(this.array[0])+a(this.array[1])+a(this.array[2])},enumerable:!0,configurable:!0},rgb:{value:function(a,b,c){return this.array[0]=a,this.array[1]=b,this.array[2]=c,this},writable:!0,enumerable:!0,configurable:!0},alpha:{value:function b(b){return this.array[3]=b,this},writable:!0,enumerable:!0,configurable:!0},rgba:{value:function(a,b,c,d){return this.rgb(a,b,c),this.alpha(d),this},writable:!0,enumerable:!0,configurable:!0},toArray:{value:function(){return this.array},writable:!0,enumerable:!0,configurable:!0}}),a}(),g={};if(WebGLRenderingContext){var h=WebGLRenderingContext;g={support:!0,drawingMode:{TRIANGLES:h.TRIANGLES,LINE_LOOP:h.LINE_LOOP,LINE_STRIP:h.LINE_STRIP,TRIANGLE_FAN:h.TRIANGLE_FAN},drawingFunctions:{ARRAYS:1,ELEMENTS:0}}}else g.support=!1;var d=function(a,b,c){b&&Object.defineProperties(a,b),c&&Object.defineProperties(a.prototype,c)},i=function(){function a(){this.children=[],this.lights=[]}return d(a,null,{add:{value:function(a){a instanceof k?this.lights.push(a):this.children.push(a)},writable:!0,enumerable:!0,configurable:!0},remove:{value:function(a){a instanceof k?this.lights.splice(this.lights.indexOf(a),1):this.children.splice(this.children.indexOf(a),1)},writable:!0,enumerable:!0,configurable:!0}}),a}(),j=0,k=function(){this.color=new f(1,1,1),this.direction=new n(1,1,1),this.index=j++},d=function(a,b,c){b&&Object.defineProperties(a,b),c&&Object.defineProperties(a.prototype,c)},l=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},m=function(a){function b(){for(var a=16;a--;)this.push(0)}return l(b,a),d(b,null,{identity:{value:function(){for(var a=16;a--;)this[a]=a%5===0?1:0;return this},writable:!0,enumerable:!0,configurable:!0},determinant:{value:function(){var a=this[0],b=this[1],c=this[2],d=this[3],e=this[4],f=this[5],g=this[6],h=this[7],i=this[8],j=this[9],k=this[10],l=this[11],m=this[12],n=this[13],o=this[14],p=this[15],q=a*f-b*e,r=a*g-c*e,s=a*h-d*e,t=b*g-c*f,u=b*h-d*f,v=c*h-d*g,w=i*n-j*m,x=i*o-k*m,y=i*p-l*m,z=j*o-k*n,A=j*p-l*n,B=k*p-l*o;return q*B-r*A+s*z+t*y-u*x+v*w},writable:!0,enumerable:!0,configurable:!0},perspective:{value:function(a,b,c,d){var e=1/Math.tan(a/2),f=1/(c-d);return this[0]=e/b,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=e,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=(d+c)*f,this[11]=-1,this[12]=0,this[13]=0,this[14]=2*d*c*f,this[15]=0,this},writable:!0,enumerable:!0,configurable:!0},lookAt:{value:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=a[0],o=a[1],p=a[2],q=c[0],r=c[1],s=c[2],t=b[0],u=b[1],w=b[2];return Math.abs(n-t)<v&&Math.abs(o-u)<v&&Math.abs(p-w)<v?this.identity():(j=n-t,k=o-u,l=p-w,m=1/Math.sqrt(j*j+k*k+l*l),j*=m,k*=m,l*=m,d=r*l-s*k,e=s*j-q*l,f=q*k-r*j,m=Math.sqrt(d*d+e*e+f*f),m?(m=1/m,d*=m,e*=m,f*=m):(d=0,e=0,f=0),g=k*f-l*e,h=l*d-j*f,i=j*e-k*d,m=Math.sqrt(g*g+h*h+i*i),m?(m=1/m,g*=m,h*=m,i*=m):(g=0,h=0,i=0),this[0]=d,this[1]=g,this[2]=j,this[3]=0,this[4]=e,this[5]=h,this[6]=k,this[7]=0,this[8]=f,this[9]=i,this[10]=l,this[11]=0,this[12]=-(d*n+e*o+f*p),this[13]=-(g*n+h*o+i*p),this[14]=-(j*n+k*o+l*p),this[15]=1,this)},writable:!0,enumerable:!0,configurable:!0},translate:{value:function(a){return this[12]=this[0]*a.x+this[4]*a.y+this[8]*a.z+this[12],this[13]=this[1]*a.x+this[5]*a.y+this[9]*a.z+this[13],this[14]=this[2]*a.x+this[6]*a.y+this[10]*a.z+this[14],this[15]=this[3]*a.x+this[7]*a.y+this[11]*a.z+this[15],this},writable:!0,enumerable:!0,configurable:!0},rotate:{value:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=b.clone();return A.normalize(),c=Math.sin(a),d=Math.cos(a),e=1-d,f=this[0],g=this[1],h=this[2],i=this[3],j=this[4],k=this[5],l=this[6],m=this[7],n=this[8],o=this[9],p=this[10],q=this[11],r=A.x*A.x*e+d,s=A.y*A.x*e+A.z*c,t=A.z*A.x*e-A.y*c,u=A.x*A.y*e-A.z*c,v=A.y*A.y*e+d,w=A.z*A.y*e+A.x*c,x=A.x*A.z*e+A.y*c,y=A.y*A.z*e-A.x*c,z=A.z*A.z*e+d,this[0]=f*r+j*s+n*t,this[1]=g*r+k*s+o*t,this[2]=h*r+l*s+p*t,this[3]=i*r+m*s+q*t,this[4]=f*u+j*v+n*w,this[5]=g*u+k*v+o*w,this[6]=h*u+l*v+p*w,this[7]=i*u+m*v+q*w,this[8]=f*x+j*y+n*z,this[9]=g*x+k*y+o*z,this[10]=h*x+l*y+p*z,this[11]=i*x+m*y+q*z,this},writable:!0,enumerable:!0,configurable:!0},rotateX:{value:function(a){this.rotate(a,new n(1,0,0))},writable:!0,enumerable:!0,configurable:!0},rotateY:{value:function(a){this.rotate(a,new n(0,1,0))},writable:!0,enumerable:!0,configurable:!0},rotateZ:{value:function(a){this.rotate(a,new n(0,0,1))},writable:!0,enumerable:!0,configurable:!0},toArray:{value:function(){for(var a=[],b=16;b--;)a[b]=this[b];return a},writable:!0,enumerable:!0,configurable:!0}}),b}(Array),d=function(a,b,c){b&&Object.defineProperties(a,b),c&&Object.defineProperties(a.prototype,c)},l=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},n=function(a){function b(){var a=void 0===arguments[0]?0:arguments[0],b=void 0===arguments[1]?0:arguments[1],c=void 0===arguments[2]?0:arguments[2];this.push(a),this.push(b),this.push(c)}return l(b,a),d(b,null,{set:{value:function(a,b,c){this.x=a,this.y=b,this.z=c},writable:!0,enumerable:!0,configurable:!0},add:{value:function(a){a instanceof b?(this.x+=a.x,this.y+=a.y,this.z+=a.z):(this.x+=a,this.y+=a,this.z+=a)},writable:!0,enumerable:!0,configurable:!0},subtract:{value:function(a){a instanceof b?(this.x-=a.x,this.y-=a.y,this.z-=a.z):this.add(-a)},writable:!0,enumerable:!0,configurable:!0},multiply:{value:function(a){a instanceof b?(this.x*=a.x,this.y*=a.y,this.z*=a.z):(this.x*=a,this.y*=a,this.z*=a)},writable:!0,enumerable:!0,configurable:!0},divide:{value:function(a){a instanceof b?(this.x/=a.x,this.y/=a.y,this.z/=a.z):this.multiply(1/a)},writable:!0,enumerable:!0,configurable:!0},distance:{value:function(a){var b=a.x-this.x,c=a.y-this.y,d=a.z-this.z;return Math.sqrt(b*b+c*c+d*d)},writable:!0,enumerable:!0,configurable:!0},getLength:{value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},writable:!0,enumerable:!0,configurable:!0},normalize:{value:function(){this.divide(this.getLength())},writable:!0,enumerable:!0,configurable:!0},dot:{value:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},writable:!0,enumerable:!0,configurable:!0},cross:{value:function(a){return new b(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x)},writable:!0,enumerable:!0,configurable:!0},toArray:{value:function(){return[this.x,this.y,this.z]},writable:!0,enumerable:!0,configurable:!0},clone:{value:function(){return new b(this.x,this.y,this.z)},writable:!0,enumerable:!0,configurable:!0},x:{set:function(a){this[0]=a},get:function(){return this[0]},enumerable:!0,configurable:!0},y:{set:function(a){this[1]=a},get:function(){return this[1]},enumerable:!0,configurable:!0},z:{set:function(a){this[2]=a},get:function(){return this[2]},enumerable:!0,configurable:!0}}),b}(Array),d=function(a,b,c){b&&Object.defineProperties(a,b),c&&Object.defineProperties(a.prototype,c)},o=0,p=function(){function a(){this.scale=new n,this.position=new n,this.rotation=new n,this.vertices=[],this.vertexNormals=!1,this.vertexIndex=!1,this.vertexColor=!1,this.textureCoords=!1,this.index=o++,this.buffers={},this.drawingMode=g.drawingMode.TRIANGLES,this.darwingFunction=0,this.color=new f,this.shader=!1}return d(a,null,{getMatrix:{value:function(a){var b=new m;return b.lookAt(a.position,a.lookAt,a.up),b.translate(this.position),b.rotateX(this.rotation[0]),b.rotateY(this.rotation[1]),b.rotateZ(this.rotation[2]),b},writable:!0,enumerable:!0,configurable:!0}}),a}(),q=function(){var a=void 0===arguments[0]?640:arguments[0],b=void 0===arguments[1]?480:arguments[1];this.width=a,this.height=b},d=function(a,b,c){b&&Object.defineProperties(a,b),c&&Object.defineProperties(a.prototype,c)},r=function z(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);if(void 0===d){var e=Object.getPrototypeOf(a);return null===e?void 0:z(e,b,c)}if("value"in d&&d.writable)return d.value;var f=d.get;return void 0===f?void 0:f.call(c)},l=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(a.__proto__=b)},s=function(a){function b(a,c,d){var f=void 0===arguments[3]?null:arguments[3];r(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a,c),this.world=d,this.camera=new e,this.camera.aspect=this.width/this.height,this.camera.updatePerspective(),this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this.color=f,this.initGl()}return l(b,a),d(b,null,{initGl:{value:function(){this.gl=this.canvas.getContext("experimental-webgl"),this.gl.viewportWidth=this.canvas.width,this.gl.viewportHeight=this.canvas.height,null!==this.color&&this.gl.clearColor.apply(this.gl,this.color.array),this.gl.enable(this.gl.DEPTH_TEST)},writable:!0,enumerable:!0,configurable:!0},initShapes:{value:function(){for(var a=this.world.children.length;a--;){var b=this.world.children[a];b.shader=new t(this,b),b.buffers.vertices=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.buffers.vertices),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(b.vertices),this.gl.STATIC_DRAW),b.buffers.vertices.itemSize=3,b.buffers.vertices.numItems=b.vertices.length/3,b.vertexColor&&(b.buffers.vertexColor=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.buffers.vertexColor),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(b.vertexColor),this.gl.STATIC_DRAW),b.buffers.vertexColor.itemSize=4,b.buffers.vertexColor.numItems=b.vertexColor.length),b.vertexNormals&&(b.buffers.normals=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.buffers.normals),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(b.vertexNormals),this.gl.STATIC_DRAW),b.buffers.normals.itemSize=3,b.buffers.normals.numItems=b.vertexNormals.length),b.vertexIndex&&(b.buffers.vertexIndex=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,b.buffers.vertexIndex),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(b.vertexIndex),this.gl.STATIC_DRAW),b.buffers.vertexIndex.itemSize=1,b.buffers.vertexIndex.numItems=b.vertexIndex.length)}},writable:!0,enumerable:!0,configurable:!0},draw:{value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);for(var a=this.world.children.length;a--;){var b=this.world.children[a],c=b.buffers;b.shader.use(),b.shader.assignValues(),b.darwingFunction===g.drawingFunctions.ELEMENTS?this.gl.drawElements(b.drawingMode,c.vertexIndex.numItems,this.gl.UNSIGNED_SHORT,0):b.darwingFunction===g.drawingFunctions.ARRAYS&&this.gl.drawArrays(b.drawingMode,0,c.vertices.numItems)}},writable:!0,enumerable:!0,configurable:!0}}),b}(q),d=function(a,b,c){b&&Object.defineProperties(a,b),c&&Object.defineProperties(a.prototype,c)},t=function(){function a(a,b){this.object=b,this.renderer=a,this.uniforms={},this.attributes={},this.program=!1,this.gl=a.gl,this.create()}return d(a,null,{vertex:{value:function(){var a="",b="";a+=u.vertex.pars["default"],b+=u.vertex.main["default"];for(var c in this.renderer.world.lights){var d=this.renderer.world.lights[c],e=d.index;a+=u.vertex.pars.directionalLight(e),b+=u.vertex.main.directionalLight(e)}var f=""+a+" void main() { "+b+" }";return this.compile(f,WebGLRenderingContext.VERTEX_SHADER)},writable:!0,enumerable:!0,configurable:!0},fragment:{value:function(){var a="",b="";a+=u.fragment.pars["default"],a+=u.fragment.pars.color,b+=u.fragment.main.color,this.renderer.world.lights.length>0&&(a+=u.fragment.pars.directionalLight,b+=u.fragment.main.directionalLight);var c=""+a+" void main() { "+b+" }";return this.compile(c,WebGLRenderingContext.FRAGMENT_SHADER)},writable:!0,enumerable:!0,configurable:!0},assignValues:{value:function(){var a=this.object,b=a.buffers;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.vertices),this.attributeValue("aVertexPosition",b.vertices);try{this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b.normals),this.attributeValue("aVertexNormal",b.normals)}catch(c){}var d=a.getMatrix(this.renderer.camera);this.uniformValue("uPMatrix",this.renderer.camera.matrix.toArray()),this.uniformValue("uMVMatrix",a.getMatrix(this.renderer.camera).toArray()),this.uniformValue("uvColor",a.color.toArray());for(var e in this.renderer.world.lights){var f=this.renderer.world.lights[e],g=f.index;this.uniformValue("uLightingDirection"+g,f.direction.toArray()),this.uniformValue("uDirectionalColor"+g,f.color.array)}var h=y.create();mat4.toInverseMat3(d,h),y.transpose(h,h),this.uniformValue("uNMatrix",h)},writable:!0,enumerable:!0,configurable:!0},uniformLocation:{value:function(a){this.uniforms[a]=this.gl.getUniformLocation(this.program,a)},writable:!0,enumerable:!0,configurable:!0},attributeLocation:{value:function(a){if(this.attributes[a]=this.gl.getAttribLocation(this.program,a),-1===this.attributes[a])throw"Attribute "+a+" cannot be located";this.gl.enableVertexAttribArray(this.attributes[a])},writable:!0,enumerable:!0,configurable:!0},uniformValue:{value:function(a,b){var c=this.gl;"undefined"==typeof this.uniforms[a]&&this.uniformLocation(a),4===b.length?c.uniform4fv(this.uniforms[a],b):3===b.length?c.uniform3fv(this.uniforms[a],b):9===b.length?c.uniformMatrix3fv(this.uniforms[a],!1,b):16===b.length&&c.uniformMatrix4fv(this.uniforms[a],!1,b)},writable:!0,enumerable:!0,configurable:!0},attributeValue:{value:function(a,b){this.gl;"undefined"==typeof this.attributes[a]&&this.attributeLocation(a),-1!==this.attributes[a]&&this.gl.vertexAttribPointer(this.attributes[a],b.itemSize,this.gl.FLOAT,!1,0,0)},writable:!0,enumerable:!0,configurable:!0},use:{value:function(){this.gl.useProgram(this.program)},writable:!0,enumerable:!0,configurable:!0},compile:{value:function(a,b){var c=this.gl,d=c.createShader(b);c.shaderSource(d,a),c.compileShader(d);var e=c.getShaderParameter(d,c.COMPILE_STATUS);if(!e)throw"Could not compile shader:"+c.getShaderInfoLog(d);return d},writable:!0,enumerable:!0,configurable:!0},create:{value:function(){var a=this.gl,b=a.createProgram();a.attachShader(b,this.vertex()),a.attachShader(b,this.fragment()),a.linkProgram(b);var c=a.getProgramParameter(b,a.LINK_STATUS);if(!c)throw"program filed to link:"+a.getProgramInfoLog(b);return this.program=b,b},writable:!0,enumerable:!0,configurable:!0}}),a}(),u={vertex:{pars:{"default":"attribute vec3 aVertexNormal;\n      attribute vec3 aVertexPosition;\n      uniform mat4 uMVMatrix;\n      uniform mat4 uPMatrix; uniform mat3 uNMatrix;",directionalLight:function(a){return"varying vec3 vLightWeighting;\n        uniform vec3 uLightingDirection"+a+";\n        uniform vec3 uDirectionalColor"+a+";"}},main:{"default":"gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);",directionalLight:function(a){return"vec3 transformedNormal = uNMatrix * aVertexNormal;\n      float directionalLightWeighting"+a+" = max(dot(transformedNormal, uLightingDirection"+a+"), 0.0);\n      vLightWeighting = uDirectionalColor"+a+" * directionalLightWeighting"+a+";"}}},fragment:{pars:{"default":"precision mediump float;",color:"uniform vec3 uvColor;",directionalLight:"varying vec3 vLightWeighting;"},main:{color:"",directionalLight:"gl_FragColor = vec4(vLightWeighting + uvColor, 1.0);"}}};if(!v)var v=1e-6;if(!w)var w="undefined"!=typeof Float32Array?Float32Array:Array;var x={};x.setMatrixArrayType=function(a){w=a},"undefined"!=typeof exports&&(exports.glMatrix=x);{var y={};new Float32Array([1,0,0,0,1,0,0,0,1])}y.create=function(){var a=new w(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},y.clone=function(a){var b=new w(9);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},y.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a},y.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},y.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3],a[2]=b[6],a[3]=c,a[5]=b[7],a[6]=d,a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},y.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,o=c*l+d*m+e*n;return o?(o=1/o,a[0]=l*o,a[1]=(-k*d+e*j)*o,a[2]=(h*d-e*g)*o,a[3]=m*o,a[4]=(k*c-e*i)*o,a[5]=(-h*c+e*f)*o,a[6]=n*o,a[7]=(-j*c+d*i)*o,a[8]=(g*c-d*f)*o,a):null},y.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8];return a[0]=g*k-h*j,a[1]=e*j-d*k,a[2]=d*h-e*g,a[3]=h*i-f*k,a[4]=c*k-e*i,a[5]=e*f-c*h,a[6]=f*j-g*i,a[7]=d*i-c*j,a[8]=c*g-d*f,a},y.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*(j*f-g*i)+c*(-j*e+g*h)+d*(i*e-f*h)},y.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7],u=c[8];return a[0]=m*d+n*g+o*j,a[1]=m*e+n*h+o*k,a[2]=m*f+n*i+o*l,a[3]=p*d+q*g+r*j,a[4]=p*e+q*h+r*k,a[5]=p*f+q*i+r*l,a[6]=s*d+t*g+u*j,a[7]=s*e+t*h+u*k,a[8]=s*f+t*i+u*l,a},y.mul=y.multiply,y.translate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1];return a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=m*d+n*g+j,a[7]=m*e+n*h+k,a[8]=m*f+n*i+l,a},y.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=Math.sin(c),n=Math.cos(c);return a[0]=n*d+m*g,a[1]=n*e+m*h,a[2]=n*f+m*i,a[3]=n*g-m*d,a[4]=n*h-m*e,a[5]=n*i-m*f,a[6]=j,a[7]=k,a[8]=l,a},y.scale=function(a,b,c){var d=c[0],e=c[2];return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=e*b[3],a[4]=e*b[4],a[5]=e*b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a},y.fromMat2d=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=0,a[3]=b[2],a[4]=b[3],a[5]=0,a[6]=b[4],a[7]=b[5],a[8]=1,a},y.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return a[0]=1-(m+o),a[1]=k+r,a[2]=l-q,a[3]=k-r,a[4]=1-(j+o),a[5]=n+p,a[6]=l+q,a[7]=n-p,a[8]=1-(j+m),a},y.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"},"undefined"!=typeof exports&&(exports.mat3=y),mat4.toInverseMat3=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[4],g=a[5],h=a[6],i=a[8],j=a[9],k=a[10],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,o=c*l+d*m+e*n;return o?(o=1/o,b||(b=y.create()),b[0]=l*o,b[1]=(-k*d+e*j)*o,b[2]=(h*d-e*g)*o,b[3]=m*o,b[4]=(k*c-e*i)*o,b[5]=(-h*c+e*f)*o,b[6]=n*o,b[7]=(-j*c+d*i)*o,b[8]=(g*c-d*f)*o,b):null},a.LiThree={Renderer:q,WebGLRenderer:s,World:i,Object3D:p,Camera:e,Color:f,Math:{Vector3:n,Matrix4:m},DirectionalLight:k,ObjectFactory:{Cube:b,Sphere:c}}}(this);