!function(t){"use strict";function r(){var t=new o;return t.vertices=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],t.vertexIndex=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],t.darwingFunction=0,t.drawingMode=WebGLRenderingContext.TRIANGLES,t}function n(){for(var t=void 0===arguments[0]?1:arguments[0],r=void 0===arguments[1]?30:arguments[1],n=void 0===arguments[2]?30:arguments[2],e=new o,i=[],a=[],u=[],s=0;r>=s;s++)for(var c=s*Math.PI/r,f=Math.sin(c),h=Math.cos(c),l=0;n>=l;l++){var v=2*l*Math.PI/n,m=Math.sin(v),d=Math.cos(v),g=d*f,p=h,b=m*f,M=1-l/n,y=1-s/r;a.push(g),a.push(p),a.push(b),u.push(M),u.push(y),i.push(t*g),i.push(t*p),i.push(t*b)}for(var x=[],s=0;r>s;s++)for(var l=0;n>l;l++){var w=s*(n+1)+l,A=w+n+1;x.push(w),x.push(A),x.push(w+1),x.push(A),x.push(A+1),x.push(w+1)}return e.vertexIndex=x,e.vertexNormals=a,e.vertices=i,e.darwingFunction=0,e.drawingMode=WebGLRenderingContext.TRIANGLES,e}var e=function(t,r,n){r&&Object.defineProperties(t,r),n&&Object.defineProperties(t.prototype,n)},i=function(){function t(){var t=void 0===arguments[0]?.785398:arguments[0],r=void 0===arguments[1]?1:arguments[1],n=void 0===arguments[2]?.1:arguments[2],e=void 0===arguments[3]?100:arguments[3];this.fovy=t,this.aspect=r,this.near=n,this.far=e,this.matrix=mat4.create(),this.lookAt=[0,0,0],this.position=[0,0,5],this.up=[0,1,0],this._zoom=1}return e(t,null,{zoom:{set:function(t){if(1>t)throw"Zoom should be equal or greater than 1";this._zoom=t},get:function(){return this._zoom},enumerable:!0,configurable:!0},updatePerspective:{value:function(){var t=2*Math.atan(Math.tan(.5*this.fovy)/this._zoom);mat4.perspective(this.matrix,t,this.aspect,this.near,this.far)},writable:!0,enumerable:!0,configurable:!0}}),t}(),e=function(t,r,n){r&&Object.defineProperties(t,r),n&&Object.defineProperties(t.prototype,n)},a=function(){function t(){var t=void 0===arguments[0]?1:arguments[0],r=void 0===arguments[1]?1:arguments[1],n=void 0===arguments[2]?1:arguments[2],e=void 0===arguments[3]?1:arguments[3];this.array=[t,r,n,e]}return e(t,null,{hex:{set:function(t){var r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(r,function(t,r,n,e){return r+r+n+n+e+e});var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);this.array[0]=parseInt(n[1],16)/255,this.array[1]=parseInt(n[2],16)/255,this.array[2]=parseInt(n[3],16)/255},get:function(){var t=function(t){var r=t.toString(16);return 1==r.length?"0"+r:r};return"#"+t(this.array[0])+t(this.array[1])+t(this.array[2])},enumerable:!0,configurable:!0},toArray:{value:function(){return this.array},writable:!0,enumerable:!0,configurable:!0}}),t}(),e=function(t,r,n){r&&Object.defineProperties(t,r),n&&Object.defineProperties(t.prototype,n)},u=function(){function t(){this.children=[]}return e(t,null,{add:{value:function(t){this.children.push(t)},writable:!0,enumerable:!0,configurable:!0},remove:{value:function(t){this.children.remove(t)},writable:!0,enumerable:!0,configurable:!0}}),t}(),e=function(t,r,n){r&&Object.defineProperties(t,r),n&&Object.defineProperties(t.prototype,n)},e=(function(){function t(){var t=void 0===arguments[0]?0:arguments[0],r=void 0===arguments[1]?0:arguments[1],n=void 0===arguments[2]?0:arguments[2];this.x=t,this.y=r,this.z=n}return e(t,null,{copy:{value:function(t){t.x=this.x,t.y=this.y,t.z=this.z},writable:!0,enumerable:!0,configurable:!0},add:{value:function(r){return r instanceof t?(this.x+=r.x,this.y+=r.y,this.z+=r.z):(this.x+=r,this.y+=r,this.z+=r),this},writable:!0,enumerable:!0,configurable:!0},multiply:{value:function(r){return r instanceof t?(this.x*=r.x,this.y*=r.y,this.z*=r.z):(this.x*=r,this.y*=r,this.z*=r),this},writable:!0,enumerable:!0,configurable:!0},divide:{value:function(r){return r instanceof t?(this.x/=r.x,this.y/=r.y,this.z/=r.z):(this.x/=r,this.y/=r,this.z/=r),this},writable:!0,enumerable:!0,configurable:!0},sub:{value:function(r){return r instanceof t?(this.x-=r.x,this.y-=r.y,this.z-=r.z):(this.x-=r,this.y-=r,this.z-=r),this},writable:!0,enumerable:!0,configurable:!0},getLength:{value:function(){return Math.sqrt(this.x*this.x+this.y+this.y+this.z+this.z)},writable:!0,enumerable:!0,configurable:!0},normalize:{value:function(){var t=this.getLength();return 1!==t&&(this.x/=t,this.y/=t,this.z/=t),this},writable:!0,enumerable:!0,configurable:!0}}),t}(),function(t,r,n){r&&Object.defineProperties(t,r),n&&Object.defineProperties(t.prototype,n)}),e=(function(){function t(){this.scale=vec3.create(),this.position=vec3.create(),this.vertices=[],this.rotation=vec3.create(),this.drawingMode=!1}return e(t,null,{x:{set:function(t){this.position[0]=t},get:function(){return this.position[0]},enumerable:!0,configurable:!0},y:{set:function(t){this.position[1]=t},get:function(){return this.position[1]},enumerable:!0,configurable:!0},z:{set:function(t){this.position[2]=t},get:function(){return this.position[2]},enumerable:!0,configurable:!0},rotateX:{set:function(t){this.rotation[0]=t},get:function(){return this.rotation[0]},enumerable:!0,configurable:!0},rotateY:{set:function(t){this.rotation[1]=t},get:function(){return this.rotation[1]},enumerable:!0,configurable:!0},rotateZ:{set:function(t){this.rotation[2]=t},get:function(){return this.rotation[2]},enumerable:!0,configurable:!0}}),t}(),function(t,r,n){r&&Object.defineProperties(t,r),n&&Object.defineProperties(t.prototype,n)}),o=function(){function t(){this.scale=vec3.create(),this.position=vec3.create(),this.rotation=vec3.create(),this.vertices=[],this.vertexNormals=!1,this.vertexIndex=!1,this.vertexColor=!1,this.textureCoords=!1,this.shaderProgram=!1,this.drawingMode=!1,this.darwingFunction=1,this.buffers={},this.color=new a}return e(t,null,{x:{set:function(t){this.position[0]=t},get:function(){return this.position[0]},enumerable:!0,configurable:!0},y:{set:function(t){this.position[1]=t},get:function(){return this.position[1]},enumerable:!0,configurable:!0},z:{set:function(t){this.position[2]=t},get:function(){return this.position[2]},enumerable:!0,configurable:!0},rotateX:{set:function(t){this.rotation[0]=t},get:function(){return this.rotation[0]},enumerable:!0,configurable:!0},rotateY:{set:function(t){this.rotation[1]=t},get:function(){return this.rotation[1]},enumerable:!0,configurable:!0},rotateZ:{set:function(t){this.rotation[2]=t},get:function(){return this.rotation[2]},enumerable:!0,configurable:!0}}),t}(),s=function(){var t=void 0===arguments[0]?640:arguments[0],r=void 0===arguments[1]?480:arguments[1];this.width=t,this.height=r},e=function(t,r,n){r&&Object.defineProperties(t,r),n&&Object.defineProperties(t.prototype,n)},c=function l(t,r,n){var e=Object.getOwnPropertyDescriptor(t,r);if(void 0===e){var i=Object.getPrototypeOf(t);return null===i?void 0:l(i,r,n)}if("value"in e&&e.writable)return e.value;var a=e.get;return void 0===a?void 0:a.call(n)},f=function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(t.__proto__=r)},h=function(t){function r(t,n,e){c(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,t,n),this.world=e,this.camera=new i,this.camera.aspect=this.width/this.height,this.camera.updatePerspective(),this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this.initGl()}return f(r,t),e(r,null,{initGl:{value:function(){this.gl=this.canvas.getContext("experimental-webgl"),this.gl.viewportWidth=this.canvas.width,this.gl.viewportHeight=this.canvas.height,this.gl.clearColor(0,0,0,1),this.gl.enable(this.gl.DEPTH_TEST)},writable:!0,enumerable:!0,configurable:!0},initShapes:{value:function(){for(var t=this.world.children.length;t--;){var r=this.world.children[t];r.drawingMode===!1&&(r.drawingMode=this.gl.LINE_STRIP),r.buffers.vertices=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r.buffers.vertices),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r.vertices),this.gl.STATIC_DRAW),r.buffers.vertices.itemSize=3,r.buffers.vertices.numItems=r.vertices.length/3,r.vertexColor&&(r.buffers.vertexColor=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r.buffers.vertexColor),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r.vertexColor),this.gl.STATIC_DRAW),r.buffers.vertexColor.itemSize=4,r.buffers.vertexColor.numItems=r.vertexColor.length),r.vertexIndex&&(r.buffers.vertexIndex=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,r.buffers.vertexIndex),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(r.vertexIndex),this.gl.STATIC_DRAW),r.buffers.vertexIndex.itemSize=1,r.buffers.vertexIndex.numItems=r.vertexIndex.length);var n=this.compileShader("attribute vec3 aVertexPosition;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;void main(void) {gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);}",this.gl.VERTEX_SHADER),e=this.compileShader("precision mediump float; uniform vec4 uColor; void main(void) {gl_FragColor = uColor;}",this.gl.FRAGMENT_SHADER),i=this.createProgram(n,e);i.vertexPositionAttribute=this.gl.getAttribLocation(i,"aVertexPosition"),this.gl.enableVertexAttribArray(i.vertexPositionAttribute),i.pMatrixUniform=this.gl.getUniformLocation(i,"uPMatrix"),i.mvMatrixUniform=this.gl.getUniformLocation(i,"uMVMatrix"),i.colorUniform=this.gl.getUniformLocation(i,"uColor"),r.shaderProgram=i}},writable:!0,enumerable:!0,configurable:!0},draw:{value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);for(var t=this.world.children.length;t--;){var r=mat4.create(),n=this.world.children[t],e=n.shaderProgram;this.gl.useProgram(e),mat4.identity(r),mat4.lookAt(r,this.camera.position,this.camera.lookAt,this.camera.up),mat4.translate(r,r,n.position),mat4.rotateX(r,r,n.rotation[0]),mat4.rotateY(r,r,n.rotation[1]),mat4.rotateZ(r,r,n.rotation[2]),this.gl.uniformMatrix4fv(e.pMatrixUniform,!1,this.camera.matrix),this.gl.uniformMatrix4fv(e.mvMatrixUniform,!1,r),this.gl.uniform4fv(e.colorUniform,n.color.toArray()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n.buffers.vertices),this.gl.vertexAttribPointer(e.vertexPositionAttribute,n.buffers.vertices.itemSize,this.gl.FLOAT,!1,0,0),0==n.darwingFunction?this.gl.drawElements(n.drawingMode,n.buffers.vertexIndex.numItems,this.gl.UNSIGNED_SHORT,0):this.gl.drawArrays(n.drawingMode,0,n.buffer.vertices.numItems)}},writable:!0,enumerable:!0,configurable:!0},compileShader:{value:function(t,r){var n=this.gl.createShader(r);this.gl.shaderSource(n,t),this.gl.compileShader(n);var e=this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS);if(!e)throw"could not compile shader:"+this.gl.getShaderInfoLog(n);return n},writable:!0,enumerable:!0,configurable:!0},createProgram:{value:function(t,r){var n=this.gl.createProgram();this.gl.attachShader(n,t),this.gl.attachShader(n,r),this.gl.linkProgram(n);var e=this.gl.getProgramParameter(n,this.gl.LINK_STATUS);if(!e)throw"program filed to link:"+this.gl.getProgramInfoLog(n);return n},writable:!0,enumerable:!0,configurable:!0}}),r}(s);t.MoGl={Renderer:s,WebGLRenderer:h,World:u,Object3D:o,Camera:i,Color:a,ObjectFactory:{Cube:r,Sphere:n}}}(this),function(){"use strict";var t={};"undefined"==typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t.exports={},define(function(){return t.exports})):t.exports=window:t.exports=exports,function(t){if(!r)var r=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;var e={};e.setMatrixArrayType=function(t){n=t},"undefined"!=typeof t&&(t.glMatrix=e);var i={};i.create=function(){var t=new n(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var r=new n(2);return r[0]=t[0],r[1]=t[1],r},i.fromValues=function(t,r){var e=new n(2);return e[0]=t,e[1]=r,e},i.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t},i.set=function(t,r,n){return t[0]=r,t[1]=n,t},i.add=function(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t},i.subtract=function(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t},i.sub=i.subtract,i.multiply=function(t,r,n){return t[0]=r[0]*n[0],t[1]=r[1]*n[1],t},i.mul=i.multiply,i.divide=function(t,r,n){return t[0]=r[0]/n[0],t[1]=r[1]/n[1],t},i.div=i.divide,i.min=function(t,r,n){return t[0]=Math.min(r[0],n[0]),t[1]=Math.min(r[1],n[1]),t},i.max=function(t,r,n){return t[0]=Math.max(r[0],n[0]),t[1]=Math.max(r[1],n[1]),t},i.scale=function(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t},i.distance=function(t,r){var n=r[0]-t[0],e=r[1]-t[1];return Math.sqrt(n*n+e*e)},i.dist=i.distance,i.squaredDistance=function(t,r){var n=r[0]-t[0],e=r[1]-t[1];return n*n+e*e},i.sqrDist=i.squaredDistance,i.length=function(t){var r=t[0],n=t[1];return Math.sqrt(r*r+n*n)},i.len=i.length,i.squaredLength=function(t){var r=t[0],n=t[1];return r*r+n*n},i.sqrLen=i.squaredLength,i.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t},i.normalize=function(t,r){var n=r[0],e=r[1],i=n*n+e*e;return i>0&&(i=1/Math.sqrt(i),t[0]=r[0]*i,t[1]=r[1]*i),t},i.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]},i.cross=function(t,r,n){var e=r[0]*n[1]-r[1]*n[0];return t[0]=t[1]=0,t[2]=e,t},i.lerp=function(t,r,n,e){var i=r[0],a=r[1];return t[0]=i+e*(n[0]-i),t[1]=a+e*(n[1]-a),t},i.transformMat2=function(t,r,n){var e=r[0],i=r[1];return t[0]=n[0]*e+n[2]*i,t[1]=n[1]*e+n[3]*i,t},i.transformMat2d=function(t,r,n){var e=r[0],i=r[1];return t[0]=n[0]*e+n[2]*i+n[4],t[1]=n[1]*e+n[3]*i+n[5],t},i.transformMat3=function(t,r,n){var e=r[0],i=r[1];return t[0]=n[0]*e+n[3]*i+n[6],t[1]=n[1]*e+n[4]*i+n[7],t},i.transformMat4=function(t,r,n){var e=r[0],i=r[1];return t[0]=n[0]*e+n[4]*i+n[12],t[1]=n[1]*e+n[5]*i+n[13],t},i.forEach=function(){var t=i.create();return function(r,n,e,i,a,u){var o,s;for(n||(n=2),e||(e=0),s=i?Math.min(i*n+e,r.length):r.length,o=e;s>o;o+=n)t[0]=r[o],t[1]=r[o+1],a(t,t,u),r[o]=t[0],r[o+1]=t[1];return r}}(),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof t&&(t.vec2=i);var a={};a.create=function(){var t=new n(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var r=new n(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r},a.fromValues=function(t,r,e){var i=new n(3);return i[0]=t,i[1]=r,i[2]=e,i},a.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},a.set=function(t,r,n,e){return t[0]=r,t[1]=n,t[2]=e,t},a.add=function(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},a.subtract=function(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t},a.sub=a.subtract,a.multiply=function(t,r,n){return t[0]=r[0]*n[0],t[1]=r[1]*n[1],t[2]=r[2]*n[2],t},a.mul=a.multiply,a.divide=function(t,r,n){return t[0]=r[0]/n[0],t[1]=r[1]/n[1],t[2]=r[2]/n[2],t},a.div=a.divide,a.min=function(t,r,n){return t[0]=Math.min(r[0],n[0]),t[1]=Math.min(r[1],n[1]),t[2]=Math.min(r[2],n[2]),t},a.max=function(t,r,n){return t[0]=Math.max(r[0],n[0]),t[1]=Math.max(r[1],n[1]),t[2]=Math.max(r[2],n[2]),t},a.scale=function(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t},a.distance=function(t,r){var n=r[0]-t[0],e=r[1]-t[1],i=r[2]-t[2];return Math.sqrt(n*n+e*e+i*i)},a.dist=a.distance,a.squaredDistance=function(t,r){var n=r[0]-t[0],e=r[1]-t[1],i=r[2]-t[2];return n*n+e*e+i*i},a.sqrDist=a.squaredDistance,a.length=function(t){var r=t[0],n=t[1],e=t[2];return Math.sqrt(r*r+n*n+e*e)},a.len=a.length,a.squaredLength=function(t){var r=t[0],n=t[1],e=t[2];return r*r+n*n+e*e},a.sqrLen=a.squaredLength,a.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t},a.normalize=function(t,r){var n=r[0],e=r[1],i=r[2],a=n*n+e*e+i*i;return a>0&&(a=1/Math.sqrt(a),t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a),t},a.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},a.cross=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=n[0],o=n[1],s=n[2];return t[0]=i*s-a*o,t[1]=a*u-e*s,t[2]=e*o-i*u,t},a.lerp=function(t,r,n,e){var i=r[0],a=r[1],u=r[2];return t[0]=i+e*(n[0]-i),t[1]=a+e*(n[1]-a),t[2]=u+e*(n[2]-u),t},a.transformMat4=function(t,r,n){var e=r[0],i=r[1],a=r[2];return t[0]=n[0]*e+n[4]*i+n[8]*a+n[12],t[1]=n[1]*e+n[5]*i+n[9]*a+n[13],t[2]=n[2]*e+n[6]*i+n[10]*a+n[14],t},a.transformQuat=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=n[0],o=n[1],s=n[2],c=n[3],f=c*e+o*a-s*i,h=c*i+s*e-u*a,l=c*a+u*i-o*e,v=-u*e-o*i-s*a;return t[0]=f*c+v*-u+h*-s-l*-o,t[1]=h*c+v*-o+l*-u-f*-s,t[2]=l*c+v*-s+f*-o-h*-u,t},a.forEach=function(){var t=a.create();return function(r,n,e,i,a,u){var o,s;for(n||(n=3),e||(e=0),s=i?Math.min(i*n+e,r.length):r.length,o=e;s>o;o+=n)t[0]=r[o],t[1]=r[o+1],t[2]=r[o+2],a(t,t,u),r[o]=t[0],r[o+1]=t[1],r[o+2]=t[2];return r}}(),a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof t&&(t.vec3=a);var u={};u.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},u.clone=function(t){var r=new n(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},u.fromValues=function(t,r,e,i){var a=new n(4);return a[0]=t,a[1]=r,a[2]=e,a[3]=i,a},u.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},u.set=function(t,r,n,e,i){return t[0]=r,t[1]=n,t[2]=e,t[3]=i,t},u.add=function(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t},u.subtract=function(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t},u.sub=u.subtract,u.multiply=function(t,r,n){return t[0]=r[0]*n[0],t[1]=r[1]*n[1],t[2]=r[2]*n[2],t[3]=r[3]*n[3],t},u.mul=u.multiply,u.divide=function(t,r,n){return t[0]=r[0]/n[0],t[1]=r[1]/n[1],t[2]=r[2]/n[2],t[3]=r[3]/n[3],t},u.div=u.divide,u.min=function(t,r,n){return t[0]=Math.min(r[0],n[0]),t[1]=Math.min(r[1],n[1]),t[2]=Math.min(r[2],n[2]),t[3]=Math.min(r[3],n[3]),t},u.max=function(t,r,n){return t[0]=Math.max(r[0],n[0]),t[1]=Math.max(r[1],n[1]),t[2]=Math.max(r[2],n[2]),t[3]=Math.max(r[3],n[3]),t},u.scale=function(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t},u.distance=function(t,r){var n=r[0]-t[0],e=r[1]-t[1],i=r[2]-t[2],a=r[3]-t[3];return Math.sqrt(n*n+e*e+i*i+a*a)},u.dist=u.distance,u.squaredDistance=function(t,r){var n=r[0]-t[0],e=r[1]-t[1],i=r[2]-t[2],a=r[3]-t[3];return n*n+e*e+i*i+a*a},u.sqrDist=u.squaredDistance,u.length=function(t){var r=t[0],n=t[1],e=t[2],i=t[3];return Math.sqrt(r*r+n*n+e*e+i*i)},u.len=u.length,u.squaredLength=function(t){var r=t[0],n=t[1],e=t[2],i=t[3];return r*r+n*n+e*e+i*i},u.sqrLen=u.squaredLength,u.negate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t},u.normalize=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=n*n+e*e+i*i+a*a;return u>0&&(u=1/Math.sqrt(u),t[0]=r[0]*u,t[1]=r[1]*u,t[2]=r[2]*u,t[3]=r[3]*u),t},u.dot=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]},u.lerp=function(t,r,n,e){var i=r[0],a=r[1],u=r[2],o=r[3];return t[0]=i+e*(n[0]-i),t[1]=a+e*(n[1]-a),t[2]=u+e*(n[2]-u),t[3]=o+e*(n[3]-o),t},u.transformMat4=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3];return t[0]=n[0]*e+n[4]*i+n[8]*a+n[12]*u,t[1]=n[1]*e+n[5]*i+n[9]*a+n[13]*u,t[2]=n[2]*e+n[6]*i+n[10]*a+n[14]*u,t[3]=n[3]*e+n[7]*i+n[11]*a+n[15]*u,t},u.transformQuat=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=n[0],o=n[1],s=n[2],c=n[3],f=c*e+o*a-s*i,h=c*i+s*e-u*a,l=c*a+u*i-o*e,v=-u*e-o*i-s*a;return t[0]=f*c+v*-u+h*-s-l*-o,t[1]=h*c+v*-o+l*-u-f*-s,t[2]=l*c+v*-s+f*-o-h*-u,t},u.forEach=function(){var t=u.create();return function(r,n,e,i,a,u){var o,s;for(n||(n=4),e||(e=0),s=i?Math.min(i*n+e,r.length):r.length,o=e;s>o;o+=n)t[0]=r[o],t[1]=r[o+1],t[2]=r[o+2],t[3]=r[o+3],a(t,t,u),r[o]=t[0],r[o+1]=t[1],r[o+2]=t[2],r[o+3]=t[3];return r}}(),u.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.vec4=u);{var o={};new Float32Array([1,0,0,1])}o.create=function(){var t=new n(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},o.clone=function(t){var r=new n(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},o.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},o.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},o.transpose=function(t,r){if(t===r){var n=r[1];t[1]=r[2],t[2]=n}else t[0]=r[0],t[1]=r[2],t[2]=r[1],t[3]=r[3];return t},o.invert=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=n*a-i*e;return u?(u=1/u,t[0]=a*u,t[1]=-e*u,t[2]=-i*u,t[3]=n*u,t):null},o.adjoint=function(t,r){var n=r[0];return t[0]=r[3],t[1]=-r[1],t[2]=-r[2],t[3]=n,t},o.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},o.multiply=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=n[0],s=n[1],c=n[2],f=n[3];return t[0]=e*o+i*c,t[1]=e*s+i*f,t[2]=a*o+u*c,t[3]=a*s+u*f,t},o.mul=o.multiply,o.rotate=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=Math.sin(n),s=Math.cos(n);return t[0]=e*s+i*o,t[1]=e*-o+i*s,t[2]=a*s+u*o,t[3]=a*-o+u*s,t},o.scale=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=n[0],s=n[1];return t[0]=e*o,t[1]=i*s,t[2]=a*o,t[3]=u*s,t},o.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.mat2=o);{var s={};new Float32Array([1,0,0,1,0,0])}s.create=function(){var t=new n(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},s.clone=function(t){var r=new n(6);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r},s.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t},s.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},s.invert=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=r[4],o=r[5],s=n*a-e*i;return s?(s=1/s,t[0]=a*s,t[1]=-e*s,t[2]=-i*s,t[3]=n*s,t[4]=(i*o-a*u)*s,t[5]=(e*u-n*o)*s,t):null},s.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},s.multiply=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=r[4],s=r[5],c=n[0],f=n[1],h=n[2],l=n[3],v=n[4],m=n[5];return t[0]=e*c+i*h,t[1]=e*f+i*l,t[2]=a*c+u*h,t[3]=a*f+u*l,t[4]=c*o+h*s+v,t[5]=f*o+l*s+m,t},s.mul=s.multiply,s.rotate=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=r[4],s=r[5],c=Math.sin(n),f=Math.cos(n);return t[0]=e*f+i*c,t[1]=-e*c+i*f,t[2]=a*f+u*c,t[3]=-a*c+f*u,t[4]=f*o+c*s,t[5]=f*s-c*o,t},s.scale=function(t,r,n){var e=n[0],i=n[1];return t[0]=r[0]*e,t[1]=r[1]*i,t[2]=r[2]*e,t[3]=r[3]*i,t[4]=r[4]*e,t[5]=r[5]*i,t},s.translate=function(t,r,n){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4]+n[0],t[5]=r[5]+n[1],t},s.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},"undefined"!=typeof t&&(t.mat2d=s);{var c={};new Float32Array([1,0,0,0,1,0,0,0,1])}c.create=function(){var t=new n(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},c.clone=function(t){var r=new n(9);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},c.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},c.transpose=function(t,r){if(t===r){var n=r[1],e=r[2],i=r[5];t[1]=r[3],t[2]=r[6],t[3]=n,t[5]=r[7],t[6]=e,t[7]=i}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t},c.invert=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=r[4],o=r[5],s=r[6],c=r[7],f=r[8],h=f*u-o*c,l=-f*a+o*s,v=c*a-u*s,m=n*h+e*l+i*v;return m?(m=1/m,t[0]=h*m,t[1]=(-f*e+i*c)*m,t[2]=(o*e-i*u)*m,t[3]=l*m,t[4]=(f*n-i*s)*m,t[5]=(-o*n+i*a)*m,t[6]=v*m,t[7]=(-c*n+e*s)*m,t[8]=(u*n-e*a)*m,t):null},c.adjoint=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=r[4],o=r[5],s=r[6],c=r[7],f=r[8];return t[0]=u*f-o*c,t[1]=i*c-e*f,t[2]=e*o-i*u,t[3]=o*s-a*f,t[4]=n*f-i*s,t[5]=i*a-n*o,t[6]=a*c-u*s,t[7]=e*s-n*c,t[8]=n*u-e*a,t},c.determinant=function(t){var r=t[0],n=t[1],e=t[2],i=t[3],a=t[4],u=t[5],o=t[6],s=t[7],c=t[8];return r*(c*a-u*s)+n*(-c*i+u*o)+e*(s*i-a*o)},c.multiply=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=r[4],s=r[5],c=r[6],f=r[7],h=r[8],l=n[0],v=n[1],m=n[2],d=n[3],g=n[4],p=n[5],b=n[6],M=n[7],y=n[8];return t[0]=l*e+v*u+m*c,t[1]=l*i+v*o+m*f,t[2]=l*a+v*s+m*h,t[3]=d*e+g*u+p*c,t[4]=d*i+g*o+p*f,t[5]=d*a+g*s+p*h,t[6]=b*e+M*u+y*c,t[7]=b*i+M*o+y*f,t[8]=b*a+M*s+y*h,t},c.mul=c.multiply,c.translate=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=r[4],s=r[5],c=r[6],f=r[7],h=r[8],l=n[0],v=n[1];return t[0]=e,t[1]=i,t[2]=a,t[3]=u,t[4]=o,t[5]=s,t[6]=l*e+v*u+c,t[7]=l*i+v*o+f,t[8]=l*a+v*s+h,t},c.rotate=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=r[4],s=r[5],c=r[6],f=r[7],h=r[8],l=Math.sin(n),v=Math.cos(n);return t[0]=v*e+l*u,t[1]=v*i+l*o,t[2]=v*a+l*s,t[3]=v*u-l*e,t[4]=v*o-l*i,t[5]=v*s-l*a,t[6]=c,t[7]=f,t[8]=h,t},c.scale=function(t,r,n){var e=n[0],i=n[2];return t[0]=e*r[0],t[1]=e*r[1],t[2]=e*r[2],t[3]=i*r[3],t[4]=i*r[4],t[5]=i*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},c.fromMat2d=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t},c.fromQuat=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=n+n,o=e+e,s=i+i,c=n*u,f=n*o,h=n*s,l=e*o,v=e*s,m=i*s,d=a*u,g=a*o,p=a*s;return t[0]=1-(l+m),t[1]=f+p,t[2]=h-g,t[3]=f-p,t[4]=1-(c+m),t[5]=v+d,t[6]=h+g,t[7]=v-d,t[8]=1-(c+l),t},c.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},"undefined"!=typeof t&&(t.mat3=c);{var f={};new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}f.create=function(){var t=new n(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.clone=function(t){var r=new n(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},f.copy=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},f.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.transpose=function(t,r){if(t===r){var n=r[1],e=r[2],i=r[3],a=r[6],u=r[7],o=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=n,t[6]=r[9],t[7]=r[13],t[8]=e,t[9]=a,t[11]=r[14],t[12]=i,t[13]=u,t[14]=o}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t},f.invert=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=r[4],o=r[5],s=r[6],c=r[7],f=r[8],h=r[9],l=r[10],v=r[11],m=r[12],d=r[13],g=r[14],p=r[15],b=n*o-e*u,M=n*s-i*u,y=n*c-a*u,x=e*s-i*o,w=e*c-a*o,A=i*c-a*s,P=f*d-h*m,q=f*g-l*m,R=f*p-v*m,z=h*g-l*d,F=h*p-v*d,I=l*p-v*g,E=b*I-M*F+y*z+x*R-w*q+A*P;return E?(E=1/E,t[0]=(o*I-s*F+c*z)*E,t[1]=(i*F-e*I-a*z)*E,t[2]=(d*A-g*w+p*x)*E,t[3]=(l*w-h*A-v*x)*E,t[4]=(s*R-u*I-c*q)*E,t[5]=(n*I-i*R+a*q)*E,t[6]=(g*y-m*A-p*M)*E,t[7]=(f*A-l*y+v*M)*E,t[8]=(u*F-o*R+c*P)*E,t[9]=(e*R-n*F-a*P)*E,t[10]=(m*w-d*y+p*b)*E,t[11]=(h*y-f*w-v*b)*E,t[12]=(o*q-u*z-s*P)*E,t[13]=(n*z-e*q+i*P)*E,t[14]=(d*M-m*x-g*b)*E,t[15]=(f*x-h*M+l*b)*E,t):null},f.adjoint=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=r[4],o=r[5],s=r[6],c=r[7],f=r[8],h=r[9],l=r[10],v=r[11],m=r[12],d=r[13],g=r[14],p=r[15];return t[0]=o*(l*p-v*g)-h*(s*p-c*g)+d*(s*v-c*l),t[1]=-(e*(l*p-v*g)-h*(i*p-a*g)+d*(i*v-a*l)),t[2]=e*(s*p-c*g)-o*(i*p-a*g)+d*(i*c-a*s),t[3]=-(e*(s*v-c*l)-o*(i*v-a*l)+h*(i*c-a*s)),t[4]=-(u*(l*p-v*g)-f*(s*p-c*g)+m*(s*v-c*l)),t[5]=n*(l*p-v*g)-f*(i*p-a*g)+m*(i*v-a*l),t[6]=-(n*(s*p-c*g)-u*(i*p-a*g)+m*(i*c-a*s)),t[7]=n*(s*v-c*l)-u*(i*v-a*l)+f*(i*c-a*s),t[8]=u*(h*p-v*d)-f*(o*p-c*d)+m*(o*v-c*h),t[9]=-(n*(h*p-v*d)-f*(e*p-a*d)+m*(e*v-a*h)),t[10]=n*(o*p-c*d)-u*(e*p-a*d)+m*(e*c-a*o),t[11]=-(n*(o*v-c*h)-u*(e*v-a*h)+f*(e*c-a*o)),t[12]=-(u*(h*g-l*d)-f*(o*g-s*d)+m*(o*l-s*h)),t[13]=n*(h*g-l*d)-f*(e*g-i*d)+m*(e*l-i*h),t[14]=-(n*(o*g-s*d)-u*(e*g-i*d)+m*(e*s-i*o)),t[15]=n*(o*l-s*h)-u*(e*l-i*h)+f*(e*s-i*o),t},f.determinant=function(t){var r=t[0],n=t[1],e=t[2],i=t[3],a=t[4],u=t[5],o=t[6],s=t[7],c=t[8],f=t[9],h=t[10],l=t[11],v=t[12],m=t[13],d=t[14],g=t[15],p=r*u-n*a,b=r*o-e*a,M=r*s-i*a,y=n*o-e*u,x=n*s-i*u,w=e*s-i*o,A=c*m-f*v,P=c*d-h*v,q=c*g-l*v,R=f*d-h*m,z=f*g-l*m,F=h*g-l*d;return p*F-b*z+M*R+y*q-x*P+w*A},f.multiply=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=r[4],s=r[5],c=r[6],f=r[7],h=r[8],l=r[9],v=r[10],m=r[11],d=r[12],g=r[13],p=r[14],b=r[15],M=n[0],y=n[1],x=n[2],w=n[3];return t[0]=M*e+y*o+x*h+w*d,t[1]=M*i+y*s+x*l+w*g,t[2]=M*a+y*c+x*v+w*p,t[3]=M*u+y*f+x*m+w*b,M=n[4],y=n[5],x=n[6],w=n[7],t[4]=M*e+y*o+x*h+w*d,t[5]=M*i+y*s+x*l+w*g,t[6]=M*a+y*c+x*v+w*p,t[7]=M*u+y*f+x*m+w*b,M=n[8],y=n[9],x=n[10],w=n[11],t[8]=M*e+y*o+x*h+w*d,t[9]=M*i+y*s+x*l+w*g,t[10]=M*a+y*c+x*v+w*p,t[11]=M*u+y*f+x*m+w*b,M=n[12],y=n[13],x=n[14],w=n[15],t[12]=M*e+y*o+x*h+w*d,t[13]=M*i+y*s+x*l+w*g,t[14]=M*a+y*c+x*v+w*p,t[15]=M*u+y*f+x*m+w*b,t},f.mul=f.multiply,f.translate=function(t,r,n){var e,i,a,u,o,s,c,f,h,l,v,m,d=n[0],g=n[1],p=n[2];return r===t?(t[12]=r[0]*d+r[4]*g+r[8]*p+r[12],t[13]=r[1]*d+r[5]*g+r[9]*p+r[13],t[14]=r[2]*d+r[6]*g+r[10]*p+r[14],t[15]=r[3]*d+r[7]*g+r[11]*p+r[15]):(e=r[0],i=r[1],a=r[2],u=r[3],o=r[4],s=r[5],c=r[6],f=r[7],h=r[8],l=r[9],v=r[10],m=r[11],t[0]=e,t[1]=i,t[2]=a,t[3]=u,t[4]=o,t[5]=s,t[6]=c,t[7]=f,t[8]=h,t[9]=l,t[10]=v,t[11]=m,t[12]=e*d+o*g+h*p+r[12],t[13]=i*d+s*g+l*p+r[13],t[14]=a*d+c*g+v*p+r[14],t[15]=u*d+f*g+m*p+r[15]),t},f.scale=function(t,r,n){var e=n[0],i=n[1],a=n[2];return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=r[7]*i,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=r[11]*a,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},f.rotate=function(t,n,e,i){var a,u,o,s,c,f,h,l,v,m,d,g,p,b,M,y,x,w,A,P,q,R,z,F,I=i[0],E=i[1],L=i[2],S=Math.sqrt(I*I+E*E+L*L);return Math.abs(S)<r?null:(S=1/S,I*=S,E*=S,L*=S,a=Math.sin(e),u=Math.cos(e),o=1-u,s=n[0],c=n[1],f=n[2],h=n[3],l=n[4],v=n[5],m=n[6],d=n[7],g=n[8],p=n[9],b=n[10],M=n[11],y=I*I*o+u,x=E*I*o+L*a,w=L*I*o-E*a,A=I*E*o-L*a,P=E*E*o+u,q=L*E*o+I*a,R=I*L*o+E*a,z=E*L*o-I*a,F=L*L*o+u,t[0]=s*y+l*x+g*w,t[1]=c*y+v*x+p*w,t[2]=f*y+m*x+b*w,t[3]=h*y+d*x+M*w,t[4]=s*A+l*P+g*q,t[5]=c*A+v*P+p*q,t[6]=f*A+m*P+b*q,t[7]=h*A+d*P+M*q,t[8]=s*R+l*z+g*F,t[9]=c*R+v*z+p*F,t[10]=f*R+m*z+b*F,t[11]=h*R+d*z+M*F,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},f.rotateX=function(t,r,n){var e=Math.sin(n),i=Math.cos(n),a=r[4],u=r[5],o=r[6],s=r[7],c=r[8],f=r[9],h=r[10],l=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=a*i+c*e,t[5]=u*i+f*e,t[6]=o*i+h*e,t[7]=s*i+l*e,t[8]=c*i-a*e,t[9]=f*i-u*e,t[10]=h*i-o*e,t[11]=l*i-s*e,t},f.rotateY=function(t,r,n){var e=Math.sin(n),i=Math.cos(n),a=r[0],u=r[1],o=r[2],s=r[3],c=r[8],f=r[9],h=r[10],l=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=a*i-c*e,t[1]=u*i-f*e,t[2]=o*i-h*e,t[3]=s*i-l*e,t[8]=a*e+c*i,t[9]=u*e+f*i,t[10]=o*e+h*i,t[11]=s*e+l*i,t},f.rotateZ=function(t,r,n){var e=Math.sin(n),i=Math.cos(n),a=r[0],u=r[1],o=r[2],s=r[3],c=r[4],f=r[5],h=r[6],l=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=a*i+c*e,t[1]=u*i+f*e,t[2]=o*i+h*e,t[3]=s*i+l*e,t[4]=c*i-a*e,t[5]=f*i-u*e,t[6]=h*i-o*e,t[7]=l*i-s*e,t},f.fromRotationTranslation=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=e+e,s=i+i,c=a+a,f=e*o,h=e*s,l=e*c,v=i*s,m=i*c,d=a*c,g=u*o,p=u*s,b=u*c;return t[0]=1-(v+d),t[1]=h+b,t[2]=l-p,t[3]=0,t[4]=h-b,t[5]=1-(f+d),t[6]=m+g,t[7]=0,t[8]=l+p,t[9]=m-g,t[10]=1-(f+v),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},f.fromQuat=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=n+n,o=e+e,s=i+i,c=n*u,f=n*o,h=n*s,l=e*o,v=e*s,m=i*s,d=a*u,g=a*o,p=a*s;return t[0]=1-(l+m),t[1]=f+p,t[2]=h-g,t[3]=0,t[4]=f-p,t[5]=1-(c+m),t[6]=v+d,t[7]=0,t[8]=h+g,t[9]=v-d,t[10]=1-(c+l),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.frustum=function(t,r,n,e,i,a,u){var o=1/(n-r),s=1/(i-e),c=1/(a-u);return t[0]=2*a*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*s,t[6]=0,t[7]=0,t[8]=(n+r)*o,t[9]=(i+e)*s,t[10]=(u+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*a*2*c,t[15]=0,t},f.perspective=function(t,r,n,e,i){var a=1/Math.tan(r/2),u=1/(e-i);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+e)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*e*u,t[15]=0,t
},f.ortho=function(t,r,n,e,i,a,u){var o=1/(r-n),s=1/(e-i),c=1/(a-u);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(r+n)*o,t[13]=(i+e)*s,t[14]=(u+a)*c,t[15]=1,t},f.lookAt=function(t,n,e,i){var a,u,o,s,c,h,l,v,m,d,g=n[0],p=n[1],b=n[2],M=i[0],y=i[1],x=i[2],w=e[0],A=e[1],P=e[2];return Math.abs(g-w)<r&&Math.abs(p-A)<r&&Math.abs(b-P)<r?f.identity(t):(l=g-w,v=p-A,m=b-P,d=1/Math.sqrt(l*l+v*v+m*m),l*=d,v*=d,m*=d,a=y*m-x*v,u=x*l-M*m,o=M*v-y*l,d=Math.sqrt(a*a+u*u+o*o),d?(d=1/d,a*=d,u*=d,o*=d):(a=0,u=0,o=0),s=v*o-m*u,c=m*a-l*o,h=l*u-v*a,d=Math.sqrt(s*s+c*c+h*h),d?(d=1/d,s*=d,c*=d,h*=d):(s=0,c=0,h=0),t[0]=a,t[1]=s,t[2]=l,t[3]=0,t[4]=u,t[5]=c,t[6]=v,t[7]=0,t[8]=o,t[9]=h,t[10]=m,t[11]=0,t[12]=-(a*g+u*p+o*b),t[13]=-(s*g+c*p+h*b),t[14]=-(l*g+v*p+m*b),t[15]=1,t)},f.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},"undefined"!=typeof t&&(t.mat4=f);{var h={};new Float32Array([0,0,0,1])}h.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},h.clone=u.clone,h.fromValues=u.fromValues,h.copy=u.copy,h.set=u.set,h.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},h.setAxisAngle=function(t,r,n){n=.5*n;var e=Math.sin(n);return t[0]=e*r[0],t[1]=e*r[1],t[2]=e*r[2],t[3]=Math.cos(n),t},h.add=u.add,h.multiply=function(t,r,n){var e=r[0],i=r[1],a=r[2],u=r[3],o=n[0],s=n[1],c=n[2],f=n[3];return t[0]=e*f+u*o+i*c-a*s,t[1]=i*f+u*s+a*o-e*c,t[2]=a*f+u*c+e*s-i*o,t[3]=u*f-e*o-i*s-a*c,t},h.mul=h.multiply,h.scale=u.scale,h.rotateX=function(t,r,n){n*=.5;var e=r[0],i=r[1],a=r[2],u=r[3],o=Math.sin(n),s=Math.cos(n);return t[0]=e*s+u*o,t[1]=i*s+a*o,t[2]=a*s-i*o,t[3]=u*s-e*o,t},h.rotateY=function(t,r,n){n*=.5;var e=r[0],i=r[1],a=r[2],u=r[3],o=Math.sin(n),s=Math.cos(n);return t[0]=e*s-a*o,t[1]=i*s+u*o,t[2]=a*s+e*o,t[3]=u*s-i*o,t},h.rotateZ=function(t,r,n){n*=.5;var e=r[0],i=r[1],a=r[2],u=r[3],o=Math.sin(n),s=Math.cos(n);return t[0]=e*s+i*o,t[1]=i*s-e*o,t[2]=a*s+u*o,t[3]=u*s-a*o,t},h.calculateW=function(t,r){var n=r[0],e=r[1],i=r[2];return t[0]=n,t[1]=e,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-n*n-e*e-i*i)),t},h.dot=u.dot,h.lerp=u.lerp,h.slerp=function(t,r,n,e){var i,a,u,o,s=r[0],c=r[1],f=r[2],h=r[3],l=n[0],v=n[1],m=n[2],d=n[3],g=s*l+c*v+f*m+h*d;return Math.abs(g)>=1?(t!==r&&(t[0]=s,t[1]=c,t[2]=f,t[3]=h),t):(i=Math.acos(g),a=Math.sqrt(1-g*g),Math.abs(a)<.001?(t[0]=.5*s+.5*l,t[1]=.5*c+.5*v,t[2]=.5*f+.5*m,t[3]=.5*h+.5*d,t):(u=Math.sin((1-e)*i)/a,o=Math.sin(e*i)/a,t[0]=s*u+l*o,t[1]=c*u+v*o,t[2]=f*u+m*o,t[3]=h*u+d*o,t))},h.invert=function(t,r){var n=r[0],e=r[1],i=r[2],a=r[3],u=n*n+e*e+i*i+a*a,o=u?1/u:0;return t[0]=-n*o,t[1]=-e*o,t[2]=-i*o,t[3]=a*o,t},h.conjugate=function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t},h.length=u.length,h.len=h.length,h.squaredLength=u.squaredLength,h.sqrLen=h.squaredLength,h.normalize=u.normalize,h.fromMat3=function(){var t=[1,2,0];return function(r,n){var e,i=n[0]+n[4]+n[8];if(i>0)e=Math.sqrt(i+1),r[3]=.5*e,e=.5/e,r[0]=(n[7]-n[5])*e,r[1]=(n[2]-n[6])*e,r[2]=(n[3]-n[1])*e;else{var a=0;n[4]>n[0]&&(a=1),n[8]>n[3*a+a]&&(a=2);var u=t[a],o=t[u];e=Math.sqrt(n[3*a+a]-n[3*u+u]-n[3*o+o]+1),r[a]=.5*e,e=.5/e,r[3]=(n[3*o+u]-n[3*u+o])*e,r[u]=(n[3*u+a]+n[3*a+u])*e,r[o]=(n[3*o+a]+n[3*a+o])*e}return r}}(),h.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.quat=h)}(t.exports)}();